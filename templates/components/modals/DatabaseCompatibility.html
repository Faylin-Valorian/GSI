{% from 'components/parts/PreviewArea.html' import preview_area %}
<div class="modal fade" id="dbCompatModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content custom-panel border-info">
            <div class="modal-header border-secondary">
                <h5 class="modal-title"><i class="bi bi-database-fill-gear me-2"></i>Database Compatibility</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p class="small text-muted">Adjust the SQL Server Compatibility Level for the current database.</p>
                <div class="mb-3">
                    <label class="form-label small text-muted">Compatibility Level</label>
                    <select id="dbCompatLevel" class="form-select bg-dark text-light border-secondary">
                        <option value="100">100 (SQL Server 2008)</option>
                        <option value="110">110 (SQL Server 2012)</option>
                        <option value="120">120 (SQL Server 2014)</option>
                        <option value="130">130 (SQL Server 2016)</option>
                        <option value="140">140 (SQL Server 2017)</option>
                        <option value="150" selected>150 (SQL Server 2019)</option>
                        <option value="160">160 (SQL Server 2022)</option>
                    </select>
                </div>

                {{ preview_area('dbCompat') }}

                <div id="dbCompatResult" class="text-center small mt-2"></div>
            </div>
            <div class="modal-footer border-secondary justify-content-between">
                <button class="btn btn-sm btn-outline-warning" onclick="dbCompatMgr.toggle()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
                <div>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-info" onclick="runDbCompat()">Apply Level</button>
                </div>
            </div>
        </div>
    </div>
</div>