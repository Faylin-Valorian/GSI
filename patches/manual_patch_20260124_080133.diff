--- a/templates/components/parts/PreviewArea.html
+++ b/templates/components/parts/PreviewArea.html
@@ -0,0 +1,18 @@
+{% macro preview_area(prefix) %}
+++<div id="{{ prefix }}PreviewContainer" class="d-none bg-black border-top border-secondary p-3 mt-3 rounded">
+    <div class="d-flex justify-content-between align-items-center mb-2">
+        <div class="d-flex align-items-center">
+            <i class="bi bi-code-slash text-warning me-2"></i>
+            <label class="text-warning small fw-bold font-monospace">SQL PREVIEW</label>
+        </div>
+        <div class="btn-group">
+            <button type="button" id="{{ prefix }}BtnSave" class="btn btn-sm btn-outline-light">
+                <i class="bi bi-download me-2"></i>Save .SQL
+            </button>
+        </div>
+    </div>
+    <pre id="{{ prefix }}PreviewOutput" class="text-success small font-monospace m-0" style="max-height: 250px; overflow-y: auto; white-space: pre-wrap; user-select: text;"></pre>
+</div>
+{% endmacro %}
--- a/templates/components/scripts/PreviewManager.html
+++ b/templates/components/scripts/PreviewManager.html
@@ -0,0 +1,58 @@
+<script>
+/**
+ * Universal Preview Manager
+ * Handles Toggling, API Fetching, and File Downloading for any tool.
+ */
+class PreviewManager {
+    constructor(config) {
+        this.prefix = config.prefix;       // Unique ID prefix (e.g., 'ede', 'keli')
+        this.apiPreview = config.apiPreview; 
+        this.apiDownload = config.apiDownload;
+        this.payloadProvider = config.payloadProvider; // Function returning JSON data
+        this.filename = config.filename || 'Script.sql';
+
+        // Bind DOM Elements
+        this.container = document.getElementById(`${this.prefix}PreviewContainer`);
+        this.output = document.getElementById(`${this.prefix}PreviewOutput`);
+        this.btnSave = document.getElementById(`${this.prefix}BtnSave`);
+
+        // Bind Save Action
+        if(this.btnSave) {
+            this.btnSave.onclick = (e) => {
+                e.preventDefault();
+                e.stopPropagation();
+                this.download();
+            };
+        }
+    }
+
+    // Toggle Logic: If open, close it. If closed, generate and open.
+    toggle() {
+        if (!this.container.classList.contains('d-none')) {
+            this.container.classList.add('d-none');
+            return;
+        }
+        this.generate();
+    }
+
+    generate() {
+        const payload = this.payloadProvider();
+        if (!payload) return; // Validation failed in the provider
+
+        this.container.classList.remove('d-none');
+        this.output.innerText = 'Generating Preview...';
+
+        fetch(this.apiPreview, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) })
+        .then(r => r.json())
+        .then(d => { this.output.innerText = d.success ? d.sql : `Error: ${d.message}`; })
+        .catch(e => { this.output.innerText = `Connection Error: ${e}`; });
+    }
+
+    download() {
+        const payload = this.payloadProvider();
+        if (!payload) return;
+        fetch(this.apiDownload, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) })
+        .then(r => r.blob()).then(blob => { const url = window.URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = this.filename; document.body.appendChild(a); a.click(); a.remove(); });
+    }
+}
+</script>
--- a/templates/components/scripts.html
+++ b/templates/components/scripts.html
@@ -17,3 +17,4 @@
 {% include 'components/scripts/SetupDatabaseProcedures.html' %}
 {% include 'components/scripts/blueprint_loader.html' %}
+{% include 'components/scripts/PreviewManager.html' %}
--- a/templates/components/modals/SetupEDataTable.html
+++ b/templates/components/modals/SetupEDataTable.html
@@ -1,3 +1,4 @@
+{% from 'components/parts/PreviewArea.html' import preview_area %}
 <div class="modal fade" id="eDataModal" tabindex="-1" style="z-index: 1080;">
     <div class="modal-dialog modal-dialog-centered">
         <div class="modal-content custom-panel border-success">
@@ -29,14 +30,13 @@
                     </div>
                     <div id="eDataCurrentFile" class="text-muted small mt-1 text-truncate">Initializing...</div>
                 </div>
-                <div id="edePreviewContainer" class="d-none bg-black border-top border-secondary p-3 mt-3">
-                    <div class="d-flex justify-content-between align-items-center mb-2">
-                        <label class="text-warning small fw-bold font-monospace">SQL PREVIEW</label>
-                        <button class="btn btn-sm btn-outline-light" onclick="downloadEDataSQL()"><i class="bi bi-download me-2"></i>Save Full .SQL</button>
-                    </div>
-                    <pre id="edeSqlOutput" class="text-success small font-monospace m-0" style="max-height: 200px; overflow-y: auto; white-space: pre-wrap;"></pre>
-                </div>
+                {{ preview_area('ede') }}
                 <div id="eDataResult" class="text-center small"></div>
                 <input type="hidden" id="eDataCountyId">
             </div>
             <div class="modal-footer border-secondary justify-content-between">
-                <button id="btnEdePreview" class="btn btn-sm btn-outline-warning d-none" onclick="previewEDataSetup()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
+                <button id="btnEdePreview" class="btn btn-sm btn-outline-warning d-none" onclick="edeMgr.toggle()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
                 <div>
                 <button type="button" class="btn btn-secondary" onclick="closeEDataModal()">Close</button>
                 <button type="button" class="btn btn-success" onclick="submitEDataSetup()">Run Import</button>
--- a/templates/components/scripts/SetupEDataTable.html
+++ b/templates/components/scripts/SetupEDataTable.html
@@ -1,16 +1,11 @@
 <script>
+    let edeMgr = null;
     function openEDataModal(id, stateName, countyName) { 
         closeAllModals(); document.getElementById('eDataCountyId').value = id;
         document.getElementById('eDataDisplayPath').innerText = `/data/${stateName}/${countyName}/eData Files`;
         
-        // Init Preview Manager
-        if(!edePreviewMgr) {
-            edePreviewMgr = new PreviewManager({
-                prefix: 'ede',
-                apiPreview: '/api/tools/setup-edata/preview',
-                apiDownload: '/api/tools/setup-edata/download-sql',
-                filename: 'Setup_eData.sql',
-                payloadProvider: () => ({ county_id: document.getElementById('eDataCountyId').value })
-            });
-        }
-        edePreviewMgr.reset();
+        edeMgr = new PreviewManager({
+            prefix: 'ede', apiPreview: '/api/tools/setup-edata/preview', apiDownload: '/api/tools/setup-edata/download-sql',
+            filename: 'Setup_eData.sql', payloadProvider: () => ({ county_id: document.getElementById('eDataCountyId').value })
+        });
         
         if(typeof updateAllToolsDebug === 'function') updateAllToolsDebug();
         if(eDataModal) eDataModal.show(); 
     }
-    function closeEDataModal() { if(eDataModal) eDataModal.hide(); }
-    function previewEDataSetup() {
-        const cont = document.getElementById('edePreviewContainer');
-        if(!cont.classList.contains('d-none')) { cont.classList.add('d-none'); return; }
-        cont.classList.remove('d-none');
-        document.getElementById('edeSqlOutput').innerText = 'Generating Preview...';
-        fetch('/api/tools/setup-edata/preview', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ county_id: document.getElementById('eDataCountyId').value })})
-        .then(r => r.json()).then(d => { document.getElementById('edeSqlOutput').innerText = d.success ? d.sql : 'Error: ' + d.message; });
-    }
-    function downloadEDataSQL() {
-        window.location.href = `/api/tools/setup-edata/download-sql?county_id=${document.getElementById('eDataCountyId').value}`;
-    }
+    function closeEDataModal() { if(eDataModal) eDataModal.hide(); }
+    
     async function submitEDataSetup() {
--- a/templates/components/modals/SetupKeliTables.html
+++ b/templates/components/modals/SetupKeliTables.html
@@ -1,3 +1,4 @@
+{% from 'components/parts/PreviewArea.html' import preview_area %}
 <div class="modal fade" id="keliModal" tabindex="-1" style="z-index: 1080;">
     <div class="modal-dialog modal-dialog-centered">
         <div class="modal-content custom-panel" style="border-color: #a370f7;">
@@ -21,14 +22,13 @@
                     </div>
                     <div id="keliCurrentFile" class="text-muted small mt-1 text-truncate">Initializing...</div>
                 </div>
-                <div id="keliPreviewContainer" class="d-none bg-black border-top border-secondary p-3 mt-3">
-                    <div class="d-flex justify-content-between align-items-center mb-2">
-                        <label class="text-warning small fw-bold font-monospace">SQL PREVIEW</label>
-                        <button class="btn btn-sm btn-outline-light" onclick="downloadKeliSQL()"><i class="bi bi-download me-2"></i>Save Full .SQL</button>
-                    </div>
-                    <pre id="keliSqlOutput" class="text-success small font-monospace m-0" style="max-height: 200px; overflow-y: auto; white-space: pre-wrap;"></pre>
-                </div>
+                {{ preview_area('keli') }}
                 <div id="keliResult" class="text-center small"></div>
                 <input type="hidden" id="keliCountyId">
             </div>
             <div class="modal-footer border-secondary justify-content-between">
-                <button id="btnKeliPreview" class="btn btn-sm btn-outline-warning d-none" onclick="previewKeliSetup()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
+                <button id="btnKeliPreview" class="btn btn-sm btn-outline-warning d-none" onclick="keliMgr.toggle()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
                 <div>
                 <button type="button" class="btn btn-secondary" onclick="closeKeliModal()">Close</button>
                 <button type="button" class="btn text-white" style="background-color: #a370f7;" onclick="submitKeliSetup()">Run Import</button>
--- a/templates/components/scripts/SetupKeliTables.html
+++ b/templates/components/scripts/SetupKeliTables.html
@@ -1,16 +1,11 @@
 <script>
+    let keliMgr = null;
     function openKeliModal(id, stateName, countyName) { 
         closeAllModals(); document.getElementById('keliCountyId').value = id;
         document.getElementById('keliDisplayPath').innerText = `/data/${stateName}/${countyName}/Keli Files`;
         
-        // Init Preview Manager
-        if(!keliPreviewMgr) {
-            keliPreviewMgr = new PreviewManager({
-                prefix: 'keli',
-                apiPreview: '/api/tools/setup-keli/preview',
-                apiDownload: '/api/tools/setup-keli/download-sql',
-                filename: 'Setup_Keli.sql',
-                payloadProvider: () => ({ county_id: document.getElementById('keliCountyId').value })
-            });
-        }
-        keliPreviewMgr.reset();
+        keliMgr = new PreviewManager({
+            prefix: 'keli', apiPreview: '/api/tools/setup-keli/preview', apiDownload: '/api/tools/setup-keli/download-sql',
+            filename: 'Setup_Keli.sql', payloadProvider: () => ({ county_id: document.getElementById('keliCountyId').value })
+        });
         
         if(typeof updateAllToolsDebug === 'function') updateAllToolsDebug();
         if(keliModal) keliModal.show(); 
     }
-    function closeKeliModal() { if(keliModal) keliModal.hide(); }
-    function previewKeliSetup() {
-        const cont = document.getElementById('keliPreviewContainer');
-        if(!cont.classList.contains('d-none')) { cont.classList.add('d-none'); return; }
-        cont.classList.remove('d-none');
-        document.getElementById('keliSqlOutput').innerText = 'Generating Preview...';
-        fetch('/api/tools/setup-keli/preview', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ county_id: document.getElementById('keliCountyId').value })})
-        .then(r => r.json()).then(d => { document.getElementById('keliSqlOutput').innerText = d.success ? d.sql : 'Error: ' + d.message; });
-    }
-    function downloadKeliSQL() {
-        window.location.href = `/api/tools/setup-keli/download-sql?county_id=${document.getElementById('keliCountyId').value}`;
-    }
+    function closeKeliModal() { if(keliModal) keliModal.hide(); }
+    
     async function submitKeliSetup() {
--- a/templates/components/modals/ImportEDataErrors.html
+++ b/templates/components/modals/ImportEDataErrors.html
@@ -1,3 +1,4 @@
+{% from 'components/parts/PreviewArea.html' import preview_area %}
 <div class="modal fade" id="importEDataErrorsModal" tabindex="-1" data-bs-backdrop="static">
     <div class="modal-dialog modal-lg modal-dialog-centered">
         <div class="modal-content custom-panel" style="border-color: #dc3545;">
@@ -20,15 +21,14 @@
                     <div id="importEdeCurrentFile" class="text-muted small mt-1 text-truncate">Initializing...</div>
                 </div>
-                <div id="importEdePreviewContainer" class="d-none bg-black border-top border-secondary p-3 mt-3">
-                    <div class="d-flex justify-content-between align-items-center mb-2">
-                        <label class="text-warning small fw-bold font-monospace">SQL PREVIEW</label>
-                        <button class="btn btn-sm btn-outline-light" onclick="downloadImportEdeSQL()"><i class="bi bi-download me-2"></i>Save Full .SQL</button>
-                    </div>
-                    <pre id="importEdeSqlOutput" class="text-success small font-monospace m-0" style="max-height: 200px; overflow-y: auto; white-space: pre-wrap;"></pre>
-                </div>
+                {{ preview_area('importEde') }}
                 <div id="importEdeResult" class="text-center small mt-3"></div>
             </div>
             <div class="modal-footer border-secondary justify-content-between">
-                <button id="btnImportEdePreview" class="btn btn-sm btn-outline-warning d-none" onclick="previewImportEde()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
+                <button id="btnImportEdePreview" class="btn btn-sm btn-outline-warning d-none" onclick="importEdeMgr.toggle()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
                 <div>
                 <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                 <button type="button" class="btn fw-bold text-white" style="background-color: #dc3545;" onclick="runImportEDataErrors()" id="btnRunImportEde">
                     <i class="bi bi-box-arrow-in-down me-1"></i>Run Import
                 </button>
--- a/templates/components/scripts/ImportEDataErrors.html
+++ b/templates/components/scripts/ImportEDataErrors.html
@@ -1,29 +1,21 @@
 <script>
     var currentImportEdeCountyId = null; 
-    let importEdePreviewMgr = null;
+    let importEdeMgr = null;
     
     function openImportEDataErrorsModal(passedId) {
         closeAllModals(); currentImportEdeCountyId = passedId;
         if(importEdeModal) importEdeModal.show();
         document.getElementById('importEdeResult').innerText = '';
         document.getElementById('importEdeProgressContainer').classList.add('d-none');
         
-        if(!importEdePreviewMgr) {
-            importEdePreviewMgr = new PreviewManager({
-                prefix: 'importEde',
-                apiPreview: '/api/tools/import-edata-errors/preview',
-                apiDownload: '/api/tools/import-edata-errors/download-sql',
-                filename: 'Import_Errors.sql',
-                payloadProvider: () => ({ county_id: currentImportEdeCountyId })
-            });
-        }
-        importEdePreviewMgr.reset();
+        importEdeMgr = new PreviewManager({
+            prefix: 'importEde', apiPreview: '/api/tools/import-edata-errors/preview', apiDownload: '/api/tools/import-edata-errors/download-sql',
+            filename: 'Import_Errors.sql', payloadProvider: () => ({ county_id: currentImportEdeCountyId })
+        });
         
         if(typeof updateAllToolsDebug === 'function') updateAllToolsDebug();
         fetch('/api/tools/import-edata-errors/init', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ county_id: passedId })})
         .then(r => r.json()).then(d => {
             if(d.success) {
                 document.getElementById('importEdeDisplayPath').innerText = d.path;
                 document.getElementById('importEdeFileCount').innerText = d.file_count + " files";
@@ -31,14 +23,6 @@
                 document.getElementById('btnRunImportEde').disabled = (d.file_count === 0);
             }
         });
-    }
-    function previewImportEde() {
-        const cont = document.getElementById('importEdePreviewContainer');
-        if(!cont.classList.contains('d-none')) { cont.classList.add('d-none'); return; }
-        cont.classList.remove('d-none');
-        document.getElementById('importEdeSqlOutput').innerText = 'Generating Preview...';
-        fetch('/api/tools/import-edata-errors/preview', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ county_id: currentImportEdeCountyId })})
-        .then(r => r.json()).then(d => { document.getElementById('importEdeSqlOutput').innerText = d.success ? d.sql : 'Error: ' + d.message; });
-    }
-    function downloadImportEdeSQL() {
-        window.location.href = `/api/tools/import-edata-errors/download-sql?county_id=${currentImportEdeCountyId}`;
     }
--- a/templates/components/modals/AlterDatabaseFields.html
+++ b/templates/components/modals/AlterDatabaseFields.html
@@ -1,3 +1,4 @@
+{% from 'components/parts/PreviewArea.html' import preview_area %}
 <div class="modal fade" id="alterDbModal" tabindex="-1" style="z-index: 1080;">
     <div class="modal-dialog modal-xl modal-dialog-centered">
         <div class="modal-content custom-panel border-info">
@@ -36,16 +37,13 @@
                 </tr>
             </tbody>
         </table>
-        <div id="alterDbPreviewContainer" class="d-none bg-black border-top border-secondary p-3 mt-3">
-            <div class="d-flex justify-content-between align-items-center mb-2">
-                <label class="text-warning small fw-bold font-monospace">SQL PREVIEW</label>
-                <button class="btn btn-sm btn-outline-light" onclick="downloadAlterDbSQL()"><i class="bi bi-download me-2"></i>Save .SQL</button>
-            </div>
-            <pre id="alterDbSqlOutput" class="text-success small font-monospace m-0" style="max-height: 200px; overflow-y: auto; white-space: pre-wrap;"></pre>
-        </div>
+        {{ preview_area('alterDb') }}
     </div>
     <div class="modal-footer border-secondary justify-content-between">
-        <button id="btnAlterDbPreview" class="btn btn-sm btn-outline-warning d-none" onclick="alterDbGeneratePreview()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
+        <button id="btnAlterDbPreview" class="btn btn-sm btn-outline-warning d-none" onclick="alterDbMgr.toggle()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
         <div>
         <button type="button" class="btn btn-secondary" onclick="closeAlterDbModal()">Close</button>
         <button type="button" class="btn btn-info" onclick="alterDbRun()">Apply Changes</button>
--- a/templates/components/scripts/AlterDatabaseFields.html
+++ b/templates/components/scripts/AlterDatabaseFields.html
@@ -1,10 +1,11 @@
 <script>
+    let alterDbMgr = null;
     function openAlterDbModal() { 
         closeAlterDbModal(); 
         if(typeof updateAllToolsDebug === 'function') updateAllToolsDebug();
-        document.getElementById('alterDbPreviewContainer').classList.add('d-none');
-        document.getElementById('alterDbSqlOutput').innerText = '';
+        
+        alterDbMgr = new PreviewManager({
+            prefix: 'alterDb', apiPreview: '/api/tools/alter-db/preview', apiDownload: '/api/tools/alter-db/download-sql',
+            filename: 'Schema_Update.sql', payloadProvider: alterDbCollectData
+        });
+        
         if(alterDbModal) alterDbModal.show(); 
     }
     function closeAlterDbModal() { if(alterDbModal) alterDbModal.hide(); }
@@ -47,21 +48,4 @@
         }
         return { renames: renames, new_fields: newFields };
     }
-
-    function alterDbGeneratePreview() {
-        const cont = document.getElementById('alterDbPreviewContainer');
-        if(!cont.classList.contains('d-none')) { cont.classList.add('d-none'); return; }
-        cont.classList.remove('d-none');
-        const payload = alterDbCollectData();
-        document.getElementById('alterDbSqlOutput').innerText = 'Generating...';
-        fetch('/api/tools/alter-db/preview', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) })
-        .then(r => r.json()).then(d => document.getElementById('alterDbSqlOutput').innerText = d.success ? d.sql : "Error: " + d.message);
-    }
-
-    function downloadAlterDbSQL() {
-        const payload = alterDbCollectData();
-        fetch('/api/tools/alter-db/download-sql', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) })
-        .then(r => r.blob())
-        .then(blob => {
-            const url = window.URL.createObjectURL(blob);
-            const a = document.createElement('a'); a.href = url; a.download = "Schema_Update.sql";
-            document.body.appendChild(a); a.click(); a.remove();
-        });
-    }
-
     function alterDbRun() {
--- a/templates/components/modals/InitialPreparation.html
+++ b/templates/components/modals/InitialPreparation.html
@@ -1,3 +1,4 @@
+{% from 'components/parts/PreviewArea.html' import preview_area %}
 <div class="modal fade" id="prepModal" tabindex="-1" style="z-index: 1080;">
     <div class="modal-dialog modal-dialog-centered">
         <div class="modal-content custom-panel border-primary">
@@ -37,16 +38,8 @@
                 <div id="prepResult" class="text-center small mt-3"></div>
 
-                <div id="prepDebugPanel" class="d-none mt-3">
-                    <div class="d-flex justify-content-between align-items-center mb-2">
-                        <label class="text-warning small fw-bold">SQL Preview</label>
-                        <button class="btn btn-sm btn-outline-light" onclick="downloadPrepSQL()"><i class="bi bi-download me-2"></i>Save .SQL</button>
-                    </div>
-                    <textarea id="prepSqlPreview" class="form-control bg-black text-success font-monospace small mb-2" rows="6" readonly></textarea>
-                </div>
+                {{ preview_area('prep') }}
                 
                 <div id="prepProgressContainer" class="d-none mb-3">
                     <div class="progress" style="height: 5px;">
                         <div id="prepProgressBar" class="progress-bar bg-primary" style="width: 0%"></div>
                     </div>
                 </div>
             </div>
             <div class="modal-footer border-secondary justify-content-between">
-                <button id="btnPrepPreview" class="btn btn-sm btn-outline-warning d-none" onclick="previewPrepSql()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
+                <button id="btnPrepPreview" class="btn btn-sm btn-outline-warning d-none" onclick="prepMgr.toggle()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
                 <div>
                 <button type="button" class="btn btn-secondary" onclick="closePrepModal()">Close</button>
--- a/templates/components/scripts/InitialPreparation.html
+++ b/templates/components/scripts/InitialPreparation.html
@@ -1,13 +1,16 @@
 <script>
     let currentPrepCountyId = null;
+    let prepMgr = null;
     function openPrepModal(id, name) {
         closeAllModals(); currentPrepCountyId = id;
         document.getElementById('prepCountyName').innerText = name;
-        document.getElementById('prepDebugPanel').classList.add('d-none');
+        
+        prepMgr = new PreviewManager({
+            prefix: 'prep', apiPreview: '/api/tools/initial-prep/preview', apiDownload: '/api/tools/initial-prep/download-sql',
+            filename: 'Initial_Prep.sql', 
+            payloadProvider: () => ({ county_id: currentPrepCountyId, book_start: document.getElementById('prepBookStart').value, book_end: document.getElementById('prepBookEnd').value })
+        });
+        
         if(typeof updateAllToolsDebug === 'function') updateAllToolsDebug();
         if(prepModal) prepModal.show();
     }
     function closePrepModal() { if(prepModal) prepModal.hide(); }
-    function previewPrepSql() {
-        const btn = document.getElementById('btnPrepPreview');
-        const cont = document.getElementById('prepDebugPanel');
-        if(!cont.classList.contains('d-none')) { cont.classList.add('d-none'); return; }
-        
-        const textarea = document.getElementById('prepSqlPreview');
-        btn.disabled = true;
-        fetch('/api/tools/initial-prep/preview', {
-            method: 'POST', headers: {'Content-Type': 'application/json'},
-            body: JSON.stringify({ county_id: currentPrepCountyId, book_start: document.getElementById('prepBookStart').value, book_end: document.getElementById('prepBookEnd').value })
-        }).then(r => r.json()).then(d => {
-            btn.disabled = false;
-            if(d.success) { cont.classList.remove('d-none'); textarea.value = d.sql; document.getElementById('prepResult').innerHTML = ''; } 
-            else { document.getElementById('prepResult').innerHTML = `<div class="alert alert-danger">${d.message}</div>`; }
-        }).catch(e => { btn.disabled = false; document.getElementById('prepResult').innerHTML = `<div class="alert alert-danger">Error: ${e}</div>`; });
-    }
-    function downloadPrepSQL() {
-        fetch('/api/tools/initial-prep/download-sql', {
-            method: 'POST', headers: {'Content-Type': 'application/json'},
-            body: JSON.stringify({ county_id: currentPrepCountyId, book_start: document.getElementById('prepBookStart').value, book_end: document.getElementById('prepBookEnd').value })
-        })
-        .then(r => r.blob())
-        .then(blob => {
-            const url = window.URL.createObjectURL(blob);
-            const a = document.createElement('a'); a.href = url; a.download = "Initial_Prep.sql";
-            document.body.appendChild(a); a.click(); a.remove();
-        });
-    }
-    function copyPrepSql() { navigator.clipboard.writeText(document.getElementById("prepSqlPreview").value); }
     function runPrepTool() {
--- a/templates/components/modals/InitialKeliLinkup.html
+++ b/templates/components/modals/InitialKeliLinkup.html
@@ -1,3 +1,4 @@
+{% from 'components/parts/PreviewArea.html' import preview_area %}
 <div class="modal fade" id="linkupModal" tabindex="-1" style="z-index: 1080;">
     <div class="modal-dialog modal-dialog-centered">
         <div class="modal-content custom-panel border-warning">
@@ -61,13 +62,7 @@
                     </div>
                 </div>
 
-                <div id="linkupDebugPanel" class="d-none mt-3">
-                    <div class="d-flex justify-content-between align-items-center mb-2">
-                        <label class="text-warning small fw-bold">SQL Preview</label>
-                        <button class="btn btn-sm btn-outline-light" onclick="downloadLinkupSQL()"><i class="bi bi-download me-2"></i>Save .SQL</button>
-                    </div>
-                    <textarea id="linkupSqlPreview" class="form-control bg-black text-success font-monospace small mb-2" rows="6" readonly></textarea>
-                </div>
+                {{ preview_area('linkup') }}
 
                 <div id="linkupProgressContainer" class="d-none mb-3">
                     <div class="progress" style="height: 5px;">
@@ -77,7 +72,7 @@
                 <div id="linkupResult" class="text-center small mt-3"></div>
             </div>
             <div class="modal-footer border-secondary justify-content-between">
-                <button id="btnLinkupPreview" class="btn btn-sm btn-outline-warning d-none" onclick="previewLinkupSql()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
+                <button id="btnLinkupPreview" class="btn btn-sm btn-outline-warning d-none" onclick="linkupMgr.toggle()"><i class="bi bi-code-square me-1"></i>Generate Preview</button>
                 <div>
                 <button type="button" class="btn btn-secondary" onclick="closeLinkupModal()">Close</button>
--- a/templates/components/scripts/InitialKeliLinkup.html
+++ b/templates/components/scripts/InitialKeliLinkup.html
@@ -1,13 +1,24 @@
 <script>
     let currentLinkupCountyId = null;
+    let linkupMgr = null;
     function openLinkupModal(id, name) {
         closeAllModals(); currentLinkupCountyId = id;
         document.getElementById('linkupCountyName').innerText = name;
-        document.getElementById('linkupDebugPanel').classList.add('d-none');
+        
+        linkupMgr = new PreviewManager({
+            prefix: 'linkup', apiPreview: '/api/tools/initial-keli-linkup/preview', apiDownload: '/api/tools/initial-keli-linkup/download-sql',
+            filename: 'Keli_Linkup.sql', 
+            payloadProvider: () => ({
+                county_id: currentLinkupCountyId,
+                use_book_range: document.getElementById('linkupToggleBook').checked, book_start: document.getElementById('linkupBookStart').value, book_end: document.getElementById('linkupBookEnd').value,
+                use_path: document.getElementById('linkupTogglePath').checked, image_path_prefix: document.getElementById('linkupImgPath').value,
+                split_images: document.getElementById('linkupSplitImages').checked, linkup_mode: document.querySelector('input[name="linkupMode"]:checked').value
+            })
+        });
+        
         if(typeof updateAllToolsDebug === 'function') updateAllToolsDebug();
         if(linkupModal) linkupModal.show();
     }
     function closeLinkupModal() { if(linkupModal) linkupModal.hide(); }
-    function previewLinkupSql() {
-        const btn = document.getElementById('btnLinkupPreview'); btn.disabled = true;
-        const cont = document.getElementById('linkupDebugPanel');
-        if(!cont.classList.contains('d-none')) { cont.classList.add('d-none'); btn.disabled = false; return; }
-        
-        const payload = {
-            county_id: currentLinkupCountyId,
-            use_book_range: document.getElementById('linkupToggleBook').checked,
-            book_start: document.getElementById('linkupBookStart').value,
-            book_end: document.getElementById('linkupBookEnd').value,
-            use_path: document.getElementById('linkupTogglePath').checked,
-            image_path_prefix: document.getElementById('linkupImgPath').value,
-            split_images: document.getElementById('linkupSplitImages').checked,
-            linkup_mode: document.querySelector('input[name="linkupMode"]:checked').value
-        };
-        fetch('/api/tools/initial-keli-linkup/preview', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) })
-        .then(r => r.json()).then(d => {
-            btn.disabled = false;
-            if(d.success) { document.getElementById('linkupDebugPanel').classList.remove('d-none'); document.getElementById('linkupSqlPreview').value = d.sql; document.getElementById('linkupResult').innerHTML = ''; } 
-            else { document.getElementById('linkupResult').innerHTML = `<div class="alert alert-danger">${d.message}</div>`; }
-        }).catch(e => { btn.disabled = false; document.getElementById('linkupResult').innerHTML = `<div class="alert alert-danger">Error: ${e}</div>`; });
-    }
-    function downloadLinkupSQL() {
-        const payload = {
-            county_id: currentLinkupCountyId,
-            use_book_range: document.getElementById('linkupToggleBook').checked,
-            book_start: document.getElementById('linkupBookStart').value,
-            book_end: document.getElementById('linkupBookEnd').value,
-            use_path: document.getElementById('linkupTogglePath').checked,
-            image_path_prefix: document.getElementById('linkupImgPath').value,
-            split_images: document.getElementById('linkupSplitImages').checked,
-            linkup_mode: document.querySelector('input[name="linkupMode"]:checked').value
-        };
-        fetch('/api/tools/initial-keli-linkup/download-sql', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload) })
-        .then(r => r.blob())
-        .then(blob => {
-            const url = window.URL.createObjectURL(blob);
-            const a = document.createElement('a'); a.href = url; a.download = "Keli_Linkup.sql";
-            document.body.appendChild(a); a.click(); a.remove();
-        });
-    }
-    function copyLinkupSql() { navigator.clipboard.writeText(document.getElementById("linkupSqlPreview").value); }
     function runLinkupTool() {