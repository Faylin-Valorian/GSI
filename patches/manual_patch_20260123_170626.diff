--- a/blueprints/SetupEDataTable.py
+++ b/blueprints/SetupEDataTable.py
@@ -58,19 +58,49 @@
 @login_required
 def preview_generic_import():
     if current_user.role != 'admin': return jsonify({'success': False, 'message': 'Unauthorized'}), 403
-    
-    sql = """-- PREVIEW: GenericDataImport Schema
-IF OBJECT_ID('[dbo].[GenericDataImport]', 'U') IS NOT NULL DROP TABLE [dbo].[GenericDataImport]
-CREATE TABLE [dbo].[GenericDataImport] (
-    ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
-    FN VARCHAR(1000), OriginalValue VARCHAR(MAX),
-    col01varchar VARCHAR(1000), col02varchar VARCHAR(1000), col03varchar VARCHAR(1000), col04varchar VARCHAR(1000), col05varchar VARCHAR(1000),
-    col06varchar VARCHAR(1000), col07varchar VARCHAR(1000), col08varchar VARCHAR(1000), col09varchar VARCHAR(1000), col10varchar VARCHAR(1000),
-    col01other VARCHAR(1000), col02other VARCHAR(1000), col03other VARCHAR(1000), col04other VARCHAR(1000), col05other VARCHAR(1000),
-    col06other VARCHAR(1000), col07other VARCHAR(1000), col08other VARCHAR(1000), col09other VARCHAR(1000), col10other VARCHAR(1000),
-    col11other VARCHAR(1000), col12other VARCHAR(1000), col13other VARCHAR(1000), col14other VARCHAR(1000), col15other VARCHAR(1000),
-    col16other VARCHAR(1000), col17other VARCHAR(1000), col18other VARCHAR(1000), col19other VARCHAR(1000), col20other VARCHAR(1000),
-    uf1 VARCHAR(1000), uf2 VARCHAR(1000), uf3 VARCHAR(1000), leftovers VARCHAR(1000)
-)"""
-    return jsonify({'success': True, 'sql': sql})
+
+    data = request.json
+    county_id = data.get('county_id')
+    
+    # 1. Resolve Paths
+    county = db.session.get(IndexingCounties, county_id)
+    if not county: return jsonify({'success': False, 'message': 'County not found'})
+    
+    state = IndexingStates.query.filter_by(fips_code=county.state_fips).first()
+    if not state: return jsonify({'success': False, 'message': 'State not found'})
+
+    s_clean = secure_filename(state.state_name)
+    c_clean = secure_filename(county.county_name)
+    base_folder = os.path.join(current_app.root_path, 'data', s_clean, c_clean, 'eData Files')
+    
+    if not os.path.exists(base_folder):
+        return jsonify({'success': False, 'message': 'eData Files folder not found.'})
+
+    csv_files = [f for f in os.listdir(base_folder) if f.lower().endswith('.csv')]
+    if not csv_files:
+        return jsonify({'success': True, 'sql': '-- No .csv files found.'})
+
+    # 2. Generate Preview (First 5 rows of first file)
+    sql_preview = "-- PREVIEW: Generated Insert Statements (First 5 rows of first file)\n"
+    sql_preview += f"-- Source: {csv_files[0]}\n\n"
+
+    col_list = "FN, OriginalValue, col01varchar, col02varchar, col03varchar, col04varchar, col05varchar, col06varchar, col07varchar, col08varchar, col09varchar, col10varchar, col01other, col02other, col03other, col04other, col05other, col06other, col07other, col08other, col09other, col10other, col11other, col12other, col13other, col14other, col15other, col16other, col17other, col18other, col19other, col20other, uf1, uf2, uf3, leftovers"
+
+    full_path = os.path.join(base_folder, csv_files[0])
+    try:
+        with open(full_path, 'r', encoding='utf-8', errors='replace') as f:
+            rows_shown = 0
+            for line in f:
+                if rows_shown >= 5: break
+                clean_line = line.strip()
+                if not clean_line: continue
+                
+                c_vals, o_vals, left_val = parse_line_waterfall(clean_line)
+                
+                # Escape and Format
+                vals = [csv_files[0], clean_line[:8000]] + c_vals + o_vals + ['', '', '', left_val]
+                vals_sql = ", ".join([f"'{v.replace('\'', '\'\'')}'" for v in vals])
+                
+                sql_preview += f"INSERT INTO [dbo].[GenericDataImport] ({col_list}) VALUES ({vals_sql});\n"
+                rows_shown += 1
+    except Exception as e:
+        sql_preview += f"\n-- Error reading file: {str(e)}"
+
+    return jsonify({'success': True, 'sql': sql_preview})
 
 @setup_edata_bp.route('/api/tools/setup-edata', methods=['POST'])
 @login_required